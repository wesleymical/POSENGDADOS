-- Selecionar o patrimônio total dos candidatos e classificar conforme as categorias especificadas
SELECT 
    CANDIDATO.SQ_CANDIDATO,
    CANDIDATO.NM_CANDIDATO,
    CANDIDATO.DS_CARGO,
    SUM(BENS_DE_CANDIDATO.VR_BEM_CANDIDATO) AS PATRIMONIO_TOTAL,
    MAX(BENS_DE_CANDIDATO.VR_BEM_CANDIDATO) AS MAIOR_BEM,
    CASE 
        WHEN SUM(BENS_DE_CANDIDATO.VR_BEM_CANDIDATO) BETWEEN 0 AND 999999.99 THEN 'Candidato com Patrimônio Normal'
        WHEN SUM(BENS_DE_CANDIDATO.VR_BEM_CANDIDATO) BETWEEN 1000000.00 AND 999999999.99 THEN 'Candidato com Patrimônio Milionário'
        WHEN SUM(BENS_DE_CANDIDATO.VR_BEM_CANDIDATO) > 1000000000.00 THEN 'Candidato com Patrimônio Bilionário'
        ELSE 'Candidato com Patrimônio Desconhecido'
    END AS CLASSIFICACAO
FROM 
    CANDIDATO
INNER JOIN 
    BENS_DE_CANDIDATO ON CANDIDATO.SQ_CANDIDATO = BENS_DE_CANDIDATO.SQ_CANDIDATO
WHERE 
    CANDIDATO.DS_CARGO IN ('Vereador', 'Prefeito', 'Vice-Prefeito')
GROUP BY 
    CANDIDATO.SQ_CANDIDATO, 
    CANDIDATO.NM_CANDIDATO, 
    CANDIDATO.DS_CARGO
ORDER BY 
    PATRIMONIO_TOTAL DESC;