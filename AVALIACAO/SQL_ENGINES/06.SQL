-- Total de votos para prefeito na cidade de Barueri, com filtros
SELECT 
    SUM(VOTACAO.QT_VOTOS_NOMINAIS_VALIDOS) AS TOTAL_VOTOS,
    CANDIDATO.NM_CANDIDATO,
    SITUACAO_TURNO.DS_SIT_TOT_TURNO
FROM 
    VOTACAO
INNER JOIN 
    CANDIDATO ON VOTACAO.SQ_CANDIDATO = CANDIDATO.SQ_CANDIDATO
INNER JOIN 
    SITUACAO_TURNO ON VOTACAO.CD_SIT_TOT_TURNO = SITUACAO_TURNO.CD_SIT_TOT_TURNO
WHERE 
    VOTACAO.DS_CARGO = 'Prefeito' 
    AND VOTACAO.NM_MUNICIPIO = 'Barueri'
GROUP BY 
    CANDIDATO.NM_CANDIDATO,
    SITUACAO_TURNO.DS_SIT_TOT_TURNO
ORDER BY 
    TOTAL_VOTOS DESC;