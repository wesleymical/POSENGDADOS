-- Selecionar os candidatos a Vereador eleitos e a quantidade de votos que receberam
SELECT 
    CANDIDATO.SQ_CANDIDATO,
    CANDIDATO.NM_CANDIDATO,
    VOTACAO.NM_MUNICIPIO,
    SUM(VOTACAO.QT_VOTOS_NOMINAIS_VALIDOS) AS TOTAL_VOTOS
FROM 
    CANDIDATO
INNER JOIN 
    VOTACAO ON CANDIDATO.SQ_CANDIDATO = VOTACAO.SQ_CANDIDATO
WHERE 
    CANDIDATO.DS_CARGO = 'Vereador'
    AND VOTACAO.DS_SIT_TOT_TURNO = 'ELEITO'
GROUP BY 
    CANDIDATO.SQ_CANDIDATO, 
    CANDIDATO.NM_CANDIDATO, 
    VOTACAO.NM_MUNICIPIO
ORDER BY 
    TOTAL_VOTOS DESC;
