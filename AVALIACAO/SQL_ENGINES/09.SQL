-- Criação da VIEW para consolidar todas as informações dos candidatos
CREATE VIEW CANDIDATO AS
SELECT 
    C.SQ_CANDIDATO,
    C.NM_CANDIDATO,
    C.DS_OCUPACAO,
    P.SG_PARTIDO,
    P.NM_PARTIDO,
    V.QT_VOTOS_NOMINAIS_VALIDOS AS VOTOS_RECEBIDOS,
    ISNULL(SUM(B.VR_BEM_CANDIDATO), 0) AS VALOR_BENS,
    R.LK_REDE_SOCIAL
FROM 
    CANDIDATO C
LEFT JOIN 
    PARTIDO P ON C.NR_PARTIDO = P.NR_PARTIDO
LEFT JOIN 
    VOTACAO V ON C.SQ_CANDIDATO = V.SQ_CANDIDATO
LEFT JOIN 
    BEM_CANDIDATO B ON C.SQ_CANDIDATO = B.SQ_CANDIDATO
LEFT JOIN 
    REDE_SOCIAL R ON C.SQ_CANDIDATO = R.SQ_CANDIDATO
GROUP BY 
    C.SQ_CANDIDATO,
    C.NM_CANDIDATO,
    C.DS_OCUPACAO,
    P.SG_PARTIDO,
    P.NM_PARTIDO,
    V.QT_VOTOS_NOMINAIS_VALIDOS,
    R.LK_REDE_SOCIAL;